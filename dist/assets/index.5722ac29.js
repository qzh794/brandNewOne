import{h as e,j as a,k as l,r as o,o as s,c as r,a as t,w as d,F as u,l as n,m as c,n as p,u as i,p as m,q as f}from"./vendor.24bb91d8.js";import{i as g}from"./index.1dd724be.js";import{u as w}from"./userinfor.3627df10.js";import"./userinfor.d19d596f.js";const _={class:"dialog-footer"},V={class:"dialog-footer"};var b=e({__name:"forget_password",setup(e,{expose:i}){const m=a("top"),f=l({account:null,email:"",password:"",repassword:""}),w=l({account:[{required:!0,message:"请输入您的注册账号",trigger:"blur"}],email:[{required:!0,message:"请输入您的注册邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入您想修改的密码",trigger:"blur"}],repassword:[{required:!0,message:"请再次确认您的新密码",trigger:"blur"}]}),b=l({forgetPasswordDialog:!1,changePasswordDialog:!1}),h=async()=>{const e=await(e=>{const{account:a,email:l}=e;return g({url:"/user/verifyAccountAndEmail",method:"POST",data:{account:a,email:l}})})(f);0==e.status?(p({message:"验证成功",type:"success"}),localStorage.setItem("id",e.id),b.forgetPasswordDialog=!1,b.changePasswordDialog=!0):p.error("验证失败")},v=async()=>{if(f.password==f.repassword){const e=f.repassword;await((e,a)=>g({url:"/user/changePasswordInLogin",method:"POST",data:{id:e,newPassword:a}}))(localStorage.getItem("id"),e),p({message:"修改成功",type:"success"})}else p.error("修改失败,请检查密码是否一致")};return i({open:()=>{b.forgetPasswordDialog=!0}}),(e,a)=>{const l=o("el-input"),p=o("el-form-item"),i=o("el-form"),g=o("el-button"),y=o("el-dialog");return s(),r(u,null,[t(y,{modelValue:b.forgetPasswordDialog,"onUpdate:modelValue":a[3]||(a[3]=e=>b.forgetPasswordDialog=e),title:"忘记密码",width:"400px"},{footer:d((()=>[n("span",_,[t(g,{onClick:a[2]||(a[2]=e=>b.forgetPasswordDialog=!1)},{default:d((()=>[c("取消")])),_:1}),t(g,{type:"primary",onClick:h},{default:d((()=>[c(" 下一步 ")])),_:1})])])),default:d((()=>[t(i,{class:"login-form","label-position":m.value,rules:w},{default:d((()=>[t(p,{label:"输入您的注册账号",prop:"account"},{default:d((()=>[t(l,{modelValue:f.account,"onUpdate:modelValue":a[0]||(a[0]=e=>f.account=e),placeholder:"输入您的注册账号"},null,8,["modelValue"])])),_:1}),t(p,{label:"输入您的个人邮箱",prop:"email"},{default:d((()=>[t(l,{modelValue:f.email,"onUpdate:modelValue":a[1]||(a[1]=e=>f.email=e),placeholder:"输入您的个人邮箱"},null,8,["modelValue"])])),_:1})])),_:1},8,["label-position","rules"])])),_:1},8,["modelValue"]),t(y,{modelValue:b.changePasswordDialog,"onUpdate:modelValue":a[7]||(a[7]=e=>b.changePasswordDialog=e),title:"修改密码",width:"400px"},{footer:d((()=>[n("span",V,[t(g,{onClick:a[6]||(a[6]=e=>b.changePasswordDialog=!1)},{default:d((()=>[c("取消")])),_:1}),t(g,{type:"primary",onClick:v},{default:d((()=>[c(" 确定 ")])),_:1})])])),default:d((()=>[t(i,{class:"login-form","label-position":m.value,rules:w},{default:d((()=>[t(p,{label:"输入您的新密码",prop:"password"},{default:d((()=>[t(l,{modelValue:f.password,"onUpdate:modelValue":a[4]||(a[4]=e=>f.password=e),placeholder:"输入您的新密码","show-password":""},null,8,["modelValue"])])),_:1}),t(p,{label:"再次确认您的新密码",prop:"repassword"},{default:d((()=>[t(l,{modelValue:f.repassword,"onUpdate:modelValue":a[5]||(a[5]=e=>f.repassword=e),placeholder:"再次确认您的新密码","show-password":""},null,8,["modelValue"])])),_:1})])),_:1},8,["label-position","rules"])])),_:1},8,["modelValue"])],64)}}});const h=e=>(m("data-v-67f7a4bf"),e=e(),f(),e),v={class:"common-layout"},y=h((()=>n("div",{class:"header-content"},[n("h3",null,"通用后台管理系统"),n("span",{class:"welcome"},"欢迎您的登录")],-1))),P={class:"login-wrapped"},U={class:"footer-wrapped"},k={class:"footer-button"},D=h((()=>n("div",{class:"footer-go-register"},[c(" 还没有账号？"),n("span",{class:"go-register"},"马上注册")],-1))),S={class:"footer-button"},x=h((()=>n("div",{class:"footer-content"},[n("div",{class:"title"},[n("span",null,"阿里云博客专家"),c(" | "),n("span",null,"阿里云博客专家"),c(" | "),n("span",null,"阿里云博客专家")])],-1)));var C=e({__name:"index",setup(e){const m=a("first"),f=i(),_=w(),V=l({account:null,password:""}),h=l({account:null,password:"",repassword:""}),C=async()=>{const e=await(e=>{const{account:a,password:l}=e;return g({url:"/api/login",method:"POST",data:{account:a,password:l}})})(V),{id:a}=e.results,{token:l}=e;"登录成功"==e.message?(p({message:"登录成功",type:"success"}),sessionStorage.setItem("id",a),localStorage.setItem("token",l),_.userInfor(a),f.push("/home")):p.error("登录失败")},I=async()=>{if(h.password==h.repassword){"注册账号成功"==(await(e=>{const{account:a,password:l}=e;return g({url:"/api/register",method:"POST",data:{account:a,password:l}})})(h)).message?(p({message:"注册成功",type:"success"}),m.value="first"):p.error("注册失败，请检查数据是否正确")}else p.error("注册失败")},j=a(),q=()=>{j.value.open()};return(e,a)=>{const l=o("el-header"),p=o("el-input"),i=o("el-form-item"),f=o("el-button"),g=o("el-form"),w=o("el-tab-pane"),_=o("el-tabs"),O=o("el-card"),T=o("el-main"),A=o("el-footer"),E=o("el-container");return s(),r(u,null,[n("div",v,[t(E,null,{default:d((()=>[t(l,{class:"header-wrapped"},{default:d((()=>[y])),_:1}),t(T,null,{default:d((()=>[n("div",P,[t(O,{class:"box-card"},{default:d((()=>[t(_,{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=e=>m.value=e),class:"demo-tabs",stretch:!0},{default:d((()=>[t(w,{label:"登录",name:"first"},{default:d((()=>[t(g,{class:"login-form"},{default:d((()=>[t(i,{label:"账号"},{default:d((()=>[t(p,{modelValue:V.account,"onUpdate:modelValue":a[0]||(a[0]=e=>V.account=e),placeholder:"请输入账号"},null,8,["modelValue"])])),_:1}),t(i,{label:"密码"},{default:d((()=>[t(p,{modelValue:V.password,"onUpdate:modelValue":a[1]||(a[1]=e=>V.password=e),placeholder:"请输入密码","show-password":""},null,8,["modelValue"])])),_:1}),n("div",U,[n("div",{class:"forget-password"},[n("span",{class:"forget-password-button",onClick:q},"忘记密码")]),n("div",k,[t(f,{type:"primary",onClick:C},{default:d((()=>[c("登录")])),_:1})]),D])])),_:1})])),_:1}),t(w,{label:"注册",name:"second"},{default:d((()=>[t(g,{class:"login-form"},{default:d((()=>[t(i,{label:"账号"},{default:d((()=>[t(p,{modelValue:h.account,"onUpdate:modelValue":a[2]||(a[2]=e=>h.account=e),placeholder:"账号长度6-12位"},null,8,["modelValue"])])),_:1}),t(i,{label:"密码"},{default:d((()=>[t(p,{modelValue:h.password,"onUpdate:modelValue":a[3]||(a[3]=e=>h.password=e),placeholder:"密码需长度6-12位含字母数字"},null,8,["modelValue"])])),_:1}),t(i,{label:"确认密码"},{default:d((()=>[t(p,{modelValue:h.repassword,"onUpdate:modelValue":a[4]||(a[4]=e=>h.repassword=e),placeholder:"请再次输入密码"},null,8,["modelValue"])])),_:1}),n("div",S,[t(f,{type:"primary",onClick:I},{default:d((()=>[c("注册")])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])])),_:1}),t(A,{class:"footer-wrapped"},{default:d((()=>[x])),_:1})])),_:1})]),t(b,{ref_key:"forgetP",ref:j},null,512)],64)}}});C.__scopeId="data-v-67f7a4bf";export{C as default};
