import{h as e,j as a,r as l,o as t,A as u,w as s,l as o,a as n,m as r,n as d,k as i,y as c,c as p,B as m,F as v,x as f,t as g,Q as _}from"./vendor.24bb91d8.js";import{b}from"./bread_crumb.4eb40394.js";import{b as y}from"./mitt.dc7cd694.js";import{l as w,g as V,i as x,r as k,s as h,m as C,f as U,n as I,o as j,p as P}from"./userinfor.d19d596f.js";import{e as z}from"./setting.1fe42162.js";import{_ as q}from"./delete_admin.vue_vue&type=script&setup=true&lang.8060493b.js";import"./index.1dd724be.js";const D={class:"dialog-footer"};var F=e({__name:"promote",setup(e,{expose:i}){const c=a();y.on("promoteId",(e=>{c.value=e}));const p=a(),m=async()=>{0==(await w(c.value,p.value)).status?(d({message:"赋权管理员成功",type:"success"}),y.emit("offDialog",1),v.value=!1):(d.error("赋权管理员失败"),v.value=!1)},v=a(!1);return i({open:()=>{v.value=!0}}),(e,a)=>{const d=l("el-radio"),i=l("el-radio-group"),c=l("el-button"),f=l("el-dialog");return t(),u(f,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),title:"赋权操作",center:"",width:"30%"},{footer:s((()=>[o("span",D,[n(c,{type:"primary",onClick:m},{default:s((()=>[r(" 确定 ")])),_:1})])])),default:s((()=>[n(i,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),class:"ml-4"},{default:s((()=>[n(d,{label:"产品管理员",size:"large"},{default:s((()=>[r("产品管理员")])),_:1}),n(d,{label:"用户管理员",size:"large"},{default:s((()=>[r("用户管理员")])),_:1}),n(d,{label:"消息管理员",size:"large"},{default:s((()=>[r("消息管理员")])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])}}});F.__scopeId="data-v-84ef2740";const R={class:"dialog-content"},A={class:"dialog-footer"};var B=e({__name:"edit_user",emits:["success"],setup(e,{expose:f,emit:g}){y.on("editId",(async e=>{const a=await V(e);b.id=e,b.account=a.account,b.name=a.name,b.sex=a.sex,b.email=a.email,b.department=a.department}));const _=a([]);(async()=>{_.value=await z()})();const b=i({id:0,account:null,name:"",sex:"",email:"",department:"",identity:"用户"}),w=i({name:[{required:!0,message:"请输入要修改的名字",trigger:"blur"}],sex:[{required:!0,message:"请输入要修改的性别",trigger:"blur"}],email:[{required:!0,message:"请输入要修改的邮箱",trigger:"blur"}],department:[{required:!0,message:"请输入要修改的部门",trigger:"blur"}]}),k=async()=>{const e=await x(b);console.log(e),0==e.status?(d({message:"创建管理员成功",type:"success"}),y.emit("offDialog",1),g("success"),h.value=!1):(d.error("创建管理员失败"),h.value=!1)},h=a(!1);return f({open:()=>{h.value=!0}}),c((()=>{y.all.clear()})),(e,a)=>{const d=l("el-input"),i=l("el-form-item"),c=l("el-option"),f=l("el-select"),g=l("el-form"),y=l("el-button"),V=l("el-dialog");return t(),u(V,{modelValue:h.value,"onUpdate:modelValue":a[5]||(a[5]=e=>h.value=e),title:"编辑用户信息",width:"600px","align-center":"",draggable:""},{footer:s((()=>[o("span",A,[n(y,{type:"primary",onClick:k},{default:s((()=>[r(" 确定 ")])),_:1})])])),default:s((()=>[o("div",R,[n(g,{ref:"ruleFormRef",model:b,rules:w,"label-width":"100px"},{default:s((()=>[n(i,{label:"账号",prop:"account"},{default:s((()=>[n(d,{modelValue:b.account,"onUpdate:modelValue":a[0]||(a[0]=e=>b.account=e),disabled:""},null,8,["modelValue"])])),_:1}),n(i,{label:"姓名",prop:"name"},{default:s((()=>[n(d,{modelValue:b.name,"onUpdate:modelValue":a[1]||(a[1]=e=>b.name=e)},null,8,["modelValue"])])),_:1}),n(i,{label:"性别",prop:"sex"},{default:s((()=>[n(f,{modelValue:b.sex,"onUpdate:modelValue":a[2]||(a[2]=e=>b.sex=e),placeholder:"请选择性别"},{default:s((()=>[n(c,{label:"男",value:"男"}),n(c,{label:"女",value:"女"})])),_:1},8,["modelValue"])])),_:1}),n(i,{label:"邮箱",prop:"email"},{default:s((()=>[n(d,{modelValue:b.email,"onUpdate:modelValue":a[3]||(a[3]=e=>b.email=e)},null,8,["modelValue"])])),_:1}),n(i,{label:"部门",prop:"department"},{default:s((()=>[n(f,{modelValue:b.department,"onUpdate:modelValue":a[4]||(a[4]=e=>b.department=e),placeholder:"请选择部门"},{default:s((()=>[(t(!0),p(v,null,m(_.value,(e=>(t(),u(c,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])}}});B.__scopeId="data-v-55cf0a4a";const M={key:0},Q={key:1};var E=e({__name:"user_infor",setup(e,{expose:u}){y.on("userId",(e=>{d.id=e.id,d.imageUrl=e.imageUrl,d.account=e.account,d.name=e.name,d.sex=e.sex,d.email=e.email,d.department=e.department,d.status=e.status}));const d=i({id:0,imageUrl:"",account:0,name:"",sex:"",email:"",department:"",status:0});y.on("offDialog",(e=>{e&&(b.value=!1)}));const m=a(),g=a(),_=a(),b=a(!1);return u({open:()=>{b.value=!0}}),c((()=>{y.all.clear()})),(e,a)=>{const u=l("el-avatar"),i=l("el-aside"),c=l("el-main"),w=l("el-container"),V=l("el-footer"),x=l("el-dialog");return t(),p(v,null,[n(x,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),title:"用户信息",width:"500px",center:"",draggable:""},{default:s((()=>[n(w,null,{default:s((()=>[n(i,{width:"200px"},{default:s((()=>[n(u,{shape:"square",size:120,src:d.imageUrl},null,8,["src"])])),_:1}),n(c,null,{default:s((()=>[o("div",null,"账号："+f(d.account),1),o("div",null,"姓名："+f(d.name),1),o("div",null,"性别："+f(d.sex),1),o("div",null,"部门："+f(d.department),1),o("div",null,"邮箱："+f(d.email),1),o("div",null,[r("状态： "),0==d.status?(t(),p("span",M,"正常")):(t(),p("span",Q,"冻结"))])])),_:1})])),_:1}),n(V,null,{default:s((()=>[o("span",{onClick:a[0]||(a[0]=e=>{return a=d.id,y.emit("editId",a),void g.value.open();var a})},"编辑"),o("span",{onClick:a[1]||(a[1]=e=>{return a=d.id,y.emit("promoteId",a),void m.value.open();var a})},"赋权"),o("span",{onClick:a[2]||(a[2]=e=>(e=>{let a={id:e,account:d.account};y.emit("deleteUserId",a),_.value.open()})(d.id))},"删除用户")])),_:1})])),_:1},8,["modelValue"]),n(F,{ref_key:"pro",ref:m},null,512),n(B,{ref_key:"editu",ref:g},null,512),n(q,{ref_key:"deleteU",ref:_},null,512)],64)}}});E.__scopeId="data-v-1605151c";const G={class:"table-wrapped"},H={class:"table-top"},J={class:"table-header"},K={class:"left-wrapped"},L={class:"search-wrapped"},N={class:"select-wrapped"},O={class:"button-wrapped"},S={class:"table-content"},T={class:"table-footer"};var W=e({__name:"index",setup(e){const w=a(),V=a({first:"用户管理",second:"用户列表"}),x=a(),q=a(),D=a([]);(async()=>{D.value=await z()})();const F=a(),R=async()=>{q.value=await C(F.value)},A=()=>{W()},B=i({pageCount:1,currentPage:1}),M=a(0),Q=async()=>{const e=await U("用户");M.value=e.length,B.pageCount=Math.ceil(e.length/10)};Q();const W=async()=>{q.value=await k(1,"用户")};W();const X=async e=>{B.currentPage=e,q.value=await k(e,"用户")},Y=async()=>{q.value=await I()},Z=a(),$=e=>{y.emit("userId",e),Z.value.open()};return y.on("offDialog",(async e=>{const a=B.currentPage;e&&(q.value=await k(B.currentPage,"用户"),0==q.value.length&&(B.currentPage=a-1,Q()))})),c((()=>{y.all.clear()})),(e,a)=>{const i=l("el-input"),c=l("el-option"),y=l("el-select"),C=l("el-button"),U=l("el-table-column"),I=l("el-tag"),z=l("el-table"),Q=l("el-pagination");return t(),p(v,null,[n(b,{ref_key:"breadcrumb",ref:w,item:V.value},null,8,["item"]),o("div",G,[o("div",H,[o("div",J,[o("div",K,[o("div",L,[n(i,{modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value=e),class:"w-50 m-2",size:"large",placeholder:"输入账号进行搜索","prefix-icon":g(_),onChange:a[1]||(a[1]=e=>(async()=>{q.value=await h(x.value)})())},null,8,["modelValue","prefix-icon"])]),o("div",N,[n(y,{modelValue:F.value,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value=e),placeholder:"请选择部门",clearable:"",onChange:R,onClear:A},{default:s((()=>[(t(!0),p(v,null,m(D.value,(e=>(t(),u(c,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),o("div",O,[n(C,{plain:"",type:"primary",onClick:Y},{default:s((()=>[r("筛选冻结用户")])),_:1}),n(C,{plain:"",type:"primary",onClick:W},{default:s((()=>[r("显示全部用户")])),_:1})])]),o("div",S,[n(z,{data:q.value,style:{width:"100%"},border:"",onRowDblclick:$},{default:s((()=>[n(U,{type:"index",width:"50"}),n(U,{prop:"account",label:"账号"}),n(U,{prop:"name",label:"姓名"}),n(U,{prop:"sex",label:"性别"}),n(U,{prop:"department",label:"部门"}),n(U,{prop:"email",label:"邮箱"}),n(U,{prop:"status",label:"状态"},{default:s((({row:e})=>[o("div",null,["1"==e.status?(t(),u(I,{key:0,class:"ml-2"},{default:s((()=>[r("冻结")])),_:1})):(t(),u(I,{key:1,class:"ml-2",type:"success"},{default:s((()=>[r("正常")])),_:1}))])])),_:1}),n(U,{prop:"create_time",label:"创建时间"},{default:s((({row:e})=>{var a;return[o("div",null,f(null==(a=e.create_time)?void 0:a.slice(0,10)),1)]})),_:1}),n(U,{prop:"update_time",label:"更新时间"},{default:s((({row:e})=>{var a;return[o("div",null,f(null==(a=e.update_time)?void 0:a.slice(0,10)),1)]})),_:1}),n(U,{label:"操作",width:"200"},{default:s((({row:e})=>[o("div",null,[n(C,{type:"primary",onClick:a=>(async e=>{0==(await j(e)).status?(d({message:"冻结用户成功",type:"success"}),q.value=await k(B.currentPage,"用户")):d.error("冻结用户失败")})(e.id),disabled:1==e.status},{default:s((()=>[r("冻结")])),_:2},1032,["onClick","disabled"]),n(C,{type:"success",onClick:a=>(async e=>{0==(await P(e)).status?(d({message:"解冻用户成功",type:"success"}),q.value=await k(B.currentPage,"用户")):d.error("解冻用户失败")})(e.id),disabled:0==e.status},{default:s((()=>[r("解冻")])),_:2},1032,["onClick","disabled"])])])),_:1})])),_:1},8,["data"])])]),o("div",T,[n(Q,{"page-size":1,"ccurrent-page":B.currentPage,"pager-count":7,total:M.value,"page-count":B.pageCount,onCurrentChange:X,layout:"prev, pager, next"},null,8,["ccurrent-page","total","page-count"])])]),n(E,{ref_key:"useri",ref:Z},null,512)],64)}}});export{W as default};
